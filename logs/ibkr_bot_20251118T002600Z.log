2025-11-17 19:26:02,625 INFO Model loaded successfully
2025-11-17 19:26:02,626 INFO Connecting to IB at 127.0.0.1:7497 (attempt 1/3)
2025-11-17 19:26:02,627 INFO Connecting to 127.0.0.1:7497 with clientId 1...
2025-11-17 19:26:04,659 INFO Disconnecting
2025-11-17 19:26:04,660 ERROR API connection failed: ConnectionRefusedError(22, 'The remote computer refused the network connection', None, 1225, None)
2025-11-17 19:26:04,661 ERROR Make sure API port on TWS/IBG is open
2025-11-17 19:26:04,662 ERROR Connection attempt 1 failed: [WinError 1225] The remote computer refused the network connection
2025-11-17 19:26:09,663 INFO Connecting to IB at 127.0.0.1:7497 (attempt 2/3)
2025-11-17 19:26:09,664 INFO Connecting to 127.0.0.1:7497 with clientId 1...
2025-11-17 19:26:11,690 INFO Disconnecting
2025-11-17 19:26:11,691 ERROR API connection failed: ConnectionRefusedError(22, 'The remote computer refused the network connection', None, 1225, None)
2025-11-17 19:26:11,691 ERROR Make sure API port on TWS/IBG is open
2025-11-17 19:26:11,692 ERROR Connection attempt 2 failed: [WinError 1225] The remote computer refused the network connection
2025-11-17 19:26:16,693 INFO Connecting to IB at 127.0.0.1:7497 (attempt 3/3)
2025-11-17 19:26:16,694 INFO Connecting to 127.0.0.1:7497 with clientId 1...
2025-11-17 19:26:18,703 INFO Disconnecting
2025-11-17 19:26:18,704 ERROR API connection failed: ConnectionRefusedError(22, 'The remote computer refused the network connection', None, 1225, None)
2025-11-17 19:26:18,704 ERROR Make sure API port on TWS/IBG is open
2025-11-17 19:26:18,705 ERROR Connection attempt 3 failed: [WinError 1225] The remote computer refused the network connection
2025-11-17 19:26:18,705 ERROR Failed to connect to IB
Traceback (most recent call last):
  File "C:\Users\andre\TRADINGBOT\ibkr_bot.py", line 27, in connect_ib
    ib.connect(IB_HOST, IB_PORT, clientId=IB_CLIENT_ID)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\andre\TRADINGBOT\venv\Lib\site-packages\ib_insync\ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^
        host, port, clientId, timeout, readonly, account))
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\andre\TRADINGBOT\venv\Lib\site-packages\ib_insync\ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\andre\TRADINGBOT\venv\Lib\site-packages\ib_insync\util.py", line 341, in run
    result = loop.run_until_complete(task)
  File "C:\Users\andre\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "C:\Users\andre\TRADINGBOT\venv\Lib\site-packages\ib_insync\ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "C:\Users\andre\TRADINGBOT\venv\Lib\site-packages\ib_insync\client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "C:\Users\andre\AppData\Local\Programs\Python\Python313\Lib\asyncio\tasks.py", line 507, in wait_for
    return await fut
           ^^^^^^^^^
  File "C:\Users\andre\TRADINGBOT\venv\Lib\site-packages\ib_insync\connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        lambda: self, host, port)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\andre\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 1171, in create_connection
    raise exceptions[0]
  File "C:\Users\andre\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 1146, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
        exceptions, addrinfo, laddr_infos)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\andre\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py", line 1045, in _connect_sock
    await self.sock_connect(sock, address)
  File "C:\Users\andre\AppData\Local\Programs\Python\Python313\Lib\asyncio\proactor_events.py", line 728, in sock_connect
    return await self._proactor.connect(sock, address)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\andre\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 804, in _poll
    value = callback(transferred, key, ov)
  File "C:\Users\andre\AppData\Local\Programs\Python\Python313\Lib\asyncio\windows_events.py", line 600, in finish_connect
    ov.getresult()
    ~~~~~~~~~~~~^^
ConnectionRefusedError: [WinError 1225] The remote computer refused the network connection

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\andre\TRADINGBOT\ibkr_bot.py", line 98, in run_ibkr
    ib = connect_ib()
  File "C:\Users\andre\TRADINGBOT\ibkr_bot.py", line 40, in connect_ib
    raise ConnectionError("Could not connect to IB. Is TWS/IB Gateway running and API enabled?")
ConnectionError: Could not connect to IB. Is TWS/IB Gateway running and API enabled?
